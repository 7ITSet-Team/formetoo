!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="public/",n(n.s=29)}([,function(e,t){e.exports=require("@babel/runtime/regenerator")},function(e,t){e.exports=require("@babel/runtime/helpers/asyncToGenerator")},function(e,t){e.exports=require("@babel/runtime/helpers/classCallCheck")},function(e,t){e.exports=require("@babel/runtime/helpers/createClass")},function(e,t){e.exports=require("mongoose")},,,,,function(e,t,n){"use strict";t.a={connection:{port:8082},jwt:{secret:"SYW/:ZIFrxd')ueR#<Oj,ABzutT]QI({%MekfS9(l|7NM-&m6RTgP@)X44sOGVE",lifetime:2592e6},db:{url:"mongodb://localhost/formetoo"},nodemailer:{host:"smtp.gmail.com",port:465,secure:!0,auth:{user:"formetood@gmail.com",pass:"topotop123"}},contacts:{support:{mail:"support@formetoo.ru"}}}},function(e,t){e.exports=require("@babel/runtime/helpers/objectSpread")},function(e,t){e.exports=require("jsonwebtoken")},,function(e,t){e.exports=require("bcryptjs")},function(e,t){e.exports=require("nodemailer")},,function(e,t,n){"use strict";var r=n(1),a=n.n(r),s=n(2),i=n.n(s),o=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.category.getAll();case 2:return i=e.sent,e.abrupt("return",{result:i});case 4:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),u=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i,o,u;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.slug,e.next=3,t.category.getBySlug(i);case 3:return o=e.sent,e.next=6,o.getProducts();case 6:return u=e.sent,e.abrupt("return",{result:u});case 8:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),c=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.slug,e.next=3,t.product.getBySlug(i);case 3:return o=e.sent,e.abrupt("return",{result:o});case 5:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),p=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.slug,e.next=3,t.page.getBySlug(i);case 3:return o=e.sent,e.abrupt("return",{result:o});case 5:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),l=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.page.getMainMenu();case 2:return i=e.sent,e.abrupt("return",{result:i});case 4:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),f=n(14),d=n.n(f),h=n(12),g=n.n(h),y=n(10),m=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i,o,u,c,p,l;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.email,o=s.password,e.next=3,t.user.getByEmail(i);case 3:if(u=e.sent,c={result:void 0,error:"incorrect login-password pair"},u){e.next=7;break}return e.abrupt("return",c);case 7:if(u.isActive){e.next=9;break}return e.abrupt("return",{result:void 0,error:"need to activate account"});case 9:return e.next=11,d.a.compare(o,u.password);case 11:if(!e.sent){e.next=21;break}return e.next=15,u.getPermissions();case 15:return p=e.sent,l=g.a.sign({id:u._id},y.a.jwt.secret),r.cookie("JWT",l,{maxAge:y.a.jwt.lifetime,httpOnly:!1}),e.abrupt("return",{result:{permissions:p,user:{email:u.email,phone:u.phone,name:u.name,lastname:u.lastname}}});case 21:return e.abrupt("return",c);case 22:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),x=function(){var e=i()(a.a.mark(function e(t,n,r,s){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.clearCookie("JWT"),e.abrupt("return");case 2:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),b=n(15),v=n.n(b),w=function(e){return"\n<p>\n    Здравствуйте! Спасибо за вашу регистрацию на сайте http://formetoo.ru! Чтобы активировать аккаунт, нажмите на кнопку ниже: \n</p>\n<p>\n    <a href=".concat(e.link,">Завершить регистрацию</a>\n</p>\n")},k=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i,o,u,c,p,l,f,h,g,m,x,b;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.password,o=s.phone,u=s.email,c=s.name,p=s.lastname,u=u.toLowerCase(),e.next=4,t.user.getByEmail(u);case 4:if(!e.sent){e.next=7;break}return e.abrupt("return",{result:void 0,error:"этот email уже занят"});case 7:return e.next=9,d.a.genSalt(10);case 9:return l=e.sent,e.next=12,d.a.hash(i,l);case 12:return f=e.sent,e.next=15,new t.user({email:u,phone:o,password:f,name:c,lastname:p,role:"client",isActive:!1}).save();case 15:if(h=e.sent,!n.cookies.orderJWT){e.next=19;break}return e.next=19,t.order.setLinkOnUser(n.cookies.orderJWT,h);case 19:return g=v.a.createTransport(y.a.nodemailer),m=n.protocol+"://"+n.hostname,x="".concat(m,"/account/verify/").concat(h._id),b={from:y.a.contacts.support.mail,to:u,subject:"Account activation",html:w({link:x})},g.sendMail(b,function(e){if(e)throw e}),e.abrupt("return");case 25:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),_=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.id,e.next=3,t.user.activateById(i);case 3:return o=g.a.sign({id:i},y.a.jwt.secret),r.cookie("JWT",o,{maxAge:y.a.jwt.lifetime,httpOnly:!1}),e.abrupt("return");case 6:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),O=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((i={authorised:!!s.userByToken,permissions:[],user:{}}).authorised){e.next=3;break}return e.abrupt("return",{result:i});case 3:return e.next=5,s.userByToken.getPermissions();case 5:return i.permissions=e.sent,i.user={email:s.userByToken.email,phone:s.userByToken.phone,name:s.userByToken.name,lastname:s.userByToken.lastname},e.abrupt("return",{result:i});case 8:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),T=function(e){return"\n<p>\n    Здравствуйте! Для восстановления пароля, нажмите на кнопку ниже: \n</p>\n<p>\n    <a href=".concat(e.link,">Восстановить</a>\n</p>\n")},z=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i,o,u,c,p,l,f;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=s.type,o=s.identificator,u=void 0,"email"!==i){e.next=9;break}return o=o.toLowerCase(),e.next=6,t.user.getByEmail(o);case 6:u=e.sent,e.next=13;break;case 9:if("phone"!==i){e.next=13;break}return e.next=12,t.user.getByPhone(o);case 12:u=e.sent;case 13:if(u){e.next=15;break}return e.abrupt("return");case 15:return c=v.a.createTransport(y.a.nodemailer),p=n.protocol+"://"+n.hostname,l="".concat(p,"/account/recovery/").concat(u.email,"/").concat(u._id),f={from:y.a.contacts.support.mail,to:u.email,subject:"Account recovery",html:T({link:l})},c.sendMail(f,function(e){if(e)throw e}),e.abrupt("return");case 21:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),A=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i,o,u,c;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=s.id,o=s.password,(u=s.userByToken)||!i){e.next=6;break}return e.next=5,t.user.getByID(i);case 5:u=e.sent;case 6:if(u){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,d.a.genSalt(10);case 10:return c=e.sent,e.next=13,d.a.hash(o,c);case 13:return u.password=e.sent,u.save(),e.abrupt("return");case 16:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),j=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.order.getByUserOrOrderToken(s.userByToken,n.cookies.orderJWT);case 2:if(i=e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,i.cart();case 7:return o=e.sent,e.abrupt("return",{result:o});case 9:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),S=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i,o,u,c;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.userByToken,e.next=3,t.order.getByUserOrOrderToken(i,n.cookies.orderJWT);case 3:if(o=e.sent){e.next=6;break}return e.abrupt("return");case 6:return o.setStatus("ordered"),u=v.a.createTransport(y.a.nodemailer),c={from:y.a.contacts.support.mail,to:i.email,subject:"Thanks for your order",html:"\n<p>\n    Здравствуйте! Ваш заказ был успешно принят. В данный момент он обрабатывается.\n</p>\n"},u.sendMail(c,function(e){if(e)throw e}),e.abrupt("return");case 11:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),I=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i,o,u,c,p,l,f;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.userByToken,o=s.productID,u=s.count,e.next=3,t.order.getByUserOrOrderToken(i,n.cookies.orderJWT);case 3:if(c=e.sent){e.next=10;break}return e.next=7,t.order.createNewOrder();case 7:c=e.sent,p=g.a.sign({id:c._id},y.a.jwt.secret),r.cookie("orderJWT",p,{maxAge:y.a.jwt.lifetime,httpOnly:!1});case 10:return e.next=12,c.putInOrder(o,u);case 12:if(l=e.sent){e.next=17;break}return e.next=16,c.cart();case 16:f=e.sent;case 17:return e.abrupt("return",{error:l,result:f});case 18:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),q=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.role.getAll();case 2:return i=e.sent,e.abrupt("return",{result:i});case 4:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),H=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.role.update(s);case 2:return i=e.sent,e.abrupt("return",{error:!i});case 4:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),B=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(i=Object.keys(X)).splice(i.indexOf("guest"),1),e.abrupt("return",{result:i});case 3:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),M=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.product.getAll();case 2:return i=e.sent,e.abrupt("return",{result:i});case 4:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),D=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.product.update(s);case 2:return i=e.sent,e.abrupt("return",{error:!i});case 4:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),N=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.product.upload(s);case 2:return i=e.sent,e.abrupt("return",{error:i.error,result:i.errorRows});case 4:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),R=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.product.getData(s);case 2:return i=e.sent,o=i.error,e.abrupt("return",{error:o});case 5:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),E=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.page.getAll();case 2:return i=e.sent,e.abrupt("return",{result:i});case 4:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),$=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.page.update(s);case 2:return i=e.sent,e.abrupt("return",{error:!i});case 4:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),P=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.user.getAll();case 2:return i=e.sent,e.abrupt("return",{result:i});case 4:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),W=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.user.update(s);case 2:return i=e.sent,e.abrupt("return",{error:!i});case 4:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),J=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.tab.getAll();case 2:return i=e.sent,e.abrupt("return",{result:i});case 4:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),C=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.tab.update(s);case 2:return i=e.sent,e.abrupt("return",{error:!i});case 4:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),U=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.attribute.getAll();case 2:return i=e.sent,e.abrupt("return",{result:i});case 4:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),L=function(){var e=i()(a.a.mark(function e(t,n,r,s){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.attribute.update(s);case 2:return i=e.sent,e.abrupt("return",{error:!i});case 4:case"end":return e.stop()}},e,this)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),X=t.a={guest:{catalog:{categories:o,category:u,product:c},cart:{info:j,"put-in-order":I},content:{page:p,"main-menu":l},auth:{login:m,logout:x,registration:k,verify:_,check:O,forgot:z,"change-password":A}},client:{cart:{"placing-orders":S}},media:{},tabs:{tabs:{list:J,update:C}},attributes:{attributes:{list:U,update:L}},orders:{},users:{users:{list:P,update:W}},roles:{roles:{list:q,update:H},permissions:{list:B}},categories:{},products:{products:{list:M,update:D,"upload-data":N,"get-data":R}},pages:{pages:{list:E,update:$}},settings:{},logs:{}}},,function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),s=n(2),i=n.n(s),o=n(5),u=n.n(o),c=n(12),p=n.n(c),l=n(10),f=n(17),d=function(e){var t=new u.a.Schema({email:{type:String,unique:!0,required:!0},password:{type:String,required:!0},phone:{type:String,unique:!0,required:!0},name:{type:String,required:!0},lastname:{type:String,required:!0},isActive:{type:Boolean,required:!0},role:String},{collection:"user"});t.statics.getByToken=function(){var e=i()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=p.a.verify(t,l.a.jwt.secret),e.next=3,this.findOne({_id:new u.a.Types.ObjectId(n.id)});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.statics.getAll=function(){var e=i()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.find({},{__v:0,password:0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.statics.getByID=function(){var e=i()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findOne({_id:new u.a.Types.ObjectId(t)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.statics.getByEmail=function(){var e=i()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=t.toLowerCase(),e.next=3,this.findOne({email:t});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.statics.getByPhone=function(){var e=i()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findOne({phone:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.statics.activateById=function(){var e=i()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update({_id:new u.a.Types.ObjectId(t)},{$set:{isActive:!0}});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.methods.getPermissions=i()(a.a.mark(function t(){var n,r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.role){t.next=2;break}return t.abrupt("return",[]);case 2:if("root"!==this.role){t.next=6;break}return(n=Object.keys(f.a)).splice(n.indexOf("guest"),1),t.abrupt("return",n);case 6:return t.next=8,e.role.getByName(this.role);case 8:if(r=t.sent){t.next=11;break}return t.abrupt("return",[]);case 11:return t.abrupt("return",r.permissions||[]);case 12:case"end":return t.stop()}},t,this)})),t.statics.update=function(){var e=i()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findOne({_id:new u.a.Types.ObjectId(t._id)});case 2:if(!e.sent){e.next=16;break}if(!t.changes){e.next=10;break}return e.next=7,this.updateOne({_id:new u.a.Types.ObjectId(t._id)},{$set:t.changes});case 7:e.t0=e.sent.ok,e.next=13;break;case 10:return e.next=12,this.remove({_id:new u.a.Types.ObjectId(t._id)});case 12:e.t0=e.sent.ok;case 13:n=e.t0,e.next=19;break;case 16:return e.next=18,this.create(t);case 18:n=1;case 19:return e.abrupt("return",1===n);case 20:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.set("autoIndex",!1),e.user=u.a.model("user",t)},h=function(e){var t=new u.a.Schema({name:{type:String,unique:!0,required:!0},alias:String,permissions:[String]},{collection:"role"});t.statics.getByName=function(){var e=i()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findOne({name:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.statics.getAll=i()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.find({},{__v:0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),t.statics.update=function(){var e=i()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findOne({_id:new u.a.Types.ObjectId(t._id)});case 2:if(!e.sent){e.next=16;break}if(!t.changes){e.next=10;break}return e.next=7,this.updateOne({_id:new u.a.Types.ObjectId(t._id)},{$set:t.changes});case 7:e.t0=e.sent.ok,e.next=13;break;case 10:return e.next=12,this.remove({_id:new u.a.Types.ObjectId(t._id)});case 12:e.t0=e.sent.ok;case 13:n=e.t0,e.next=19;break;case 16:return e.next=18,this.create(t);case 18:n=1;case 19:return e.abrupt("return",1===n);case 20:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.set("autoIndex",!1),e.role=u.a.model("role",t)},g=function(e){var t=new u.a.Schema({userID:u.a.Schema.Types.ObjectId,createDate:Date,products:[],statusDate:Date,status:{type:String,required:!0},finalSum:Number},{collection:"order"});t.statics.getByUser=function(){var e=i()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.find({userID:new u.a.Types.ObjectId(t._id),status:{$not:{$eq:"closed"}}});case 2:if(!((n=e.sent)&&n.length>0)){e.next=5;break}return e.abrupt("return",n.sort(function(e,t){return t.createDate-e.createDate})[0]);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.statics.getByOrderToken=function(){var e=i()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=p.a.verify(t,l.a.jwt.secret),e.next=3,this.findOne({_id:new u.a.Types.ObjectId(n.id),status:{$not:{$eq:"closed"}}});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.statics.getByUserOrOrderToken=function(){var e=i()(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}return e.next=3,this.getByUser(t);case 3:return e.abrupt("return",e.sent);case 4:if(!n){e.next=8;break}return e.next=7,this.getByOrderToken(n);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),t.statics.createNewOrder=function(){var e=i()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new this({userID:t?t._id:void 0,createDate:new Date,products:[],statusDate:new Date,status:"created"}).save();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.statics.setLinkOnUser=function(){var e=i()(a.a.mark(function e(t,n){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=p.a.verify(t,l.a.jwt.secret),e.next=3,this.update({_id:new u.a.Types.ObjectId(r.id)},{$set:{userID:new u.a.Types.ObjectId(n._id)}});case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),t.methods.putInOrder=function(){var t=i()(a.a.mark(function t(n,r){var s,i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(s=!1,this.products.forEach(function(e){e._id.equals(n)&&(e.count=Math.max(r,0),s=!0)}),!s){t.next=7;break}return this.markModified("products"),t.next=6,this.save();case 6:return t.abrupt("return");case 7:return t.next=9,e.product.findOne({_id:n},{__v:0});case 9:if(i=t.sent){t.next=12;break}return t.abrupt("return","Продукт не найден");case 12:return this.products.push({count:Math.max(r,0),_id:i._id}),t.next=15,this.save();case 15:return t.abrupt("return");case 16:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),t.methods.setStatus=function(){var e=i()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.status=t,e.next=3,this.save();case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.methods.cart=i()(a.a.mark(function t(){var n,r,s,i,o,u;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={},r=0,s=0,i=this.products.map(function(e){return n[e._id]=e.count,e._id}),t.next=6,e.product.find({_id:{$in:i}},{__v:0});case 6:return o=t.sent,u=o.map(function(e){var t=e.toObject();return t.count=n[t._id]||0,s+=t.count,r+=t.count*t.price,t}),t.abrupt("return",{products:u,count:s,sum:r});case 9:case"end":return t.stop()}},t,this)})),t.set("autoIndex",!1),e.order=u.a.model("order",t)},y=(n(23),n(3)),m=n.n(y),x=n(4),b=n.n(x),v=function(){function e(){m()(this,e)}return b()(e,null,[{key:"csv2json",value:function(e){for(var t=[],n=e.substring(0,e.length-2).split("\n"),r=n[0].split(";"),a=1;a<=n.length-1;a++){for(var s=n[a].split(";"),i={},o=0;o<s.length;o++)i[r[o]]=s[o];t.push(i)}return t}},{key:"json2csv",value:function(e){for(var t=Object.keys(e[0].toJSON()),n="",r=0;r<t.length;r++){var a=t[r];n="".concat(n).concat(a).concat(r===t.length-1?"\n":";")}for(var s=0;s<e.length;s++)for(var i=0;i<t.length;i++){var o=e[s],u=t[i];if("media"===u)n="".concat(n).concat(o[u].toString()).concat(i===t.length-1?"\n":";");else if("props"===u){for(var c="",p=0;p<o[u].length;p++)c="".concat(c).concat(o[u][p].name,":").concat(o[u][p].value).concat(p===o[u].length-1?"":",");n="".concat(n).concat(c).concat(i===t.length-1?"\n":";")}else n="".concat(n).concat(o[u]).concat(i===t.length-1?"\n":";")}return n}}]),e}(),w=function(e){var t=new u.a.Schema({categoryID:{type:u.a.Schema.Types.ObjectId,required:!0},code:{type:String,unique:!0},name:{type:String,unique:!0,required:!0},slug:{type:String,unique:!0,required:!0},price:{type:Number,required:!0},media:[String],props:[{name:{type:String,unique:!0,required:!0},value:{}}]},{collection:"product"});t.statics.getBySlug=function(){var e=i()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findOne({slug:t},{__v:0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.statics.getByCategoryID=function(){var e=i()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.find({categoryID:new u.a.Types.ObjectId(t)},{__v:0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.statics.getAll=i()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.find({},{__v:0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),t.statics.update=function(){var e=i()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findOne({_id:new u.a.Types.ObjectId(t._id)});case 2:if(!e.sent){e.next=16;break}if(!t.changes){e.next=10;break}return e.next=7,this.updateOne({_id:new u.a.Types.ObjectId(t._id)},{$set:t.changes});case 7:e.t0=e.sent.ok,e.next=13;break;case 10:return e.next=12,this.remove({_id:new u.a.Types.ObjectId(t._id)});case 12:e.t0=e.sent.ok;case 13:n=e.t0,e.next=19;break;case 16:return e.next=18,this.create(t);case 18:n=1;case 19:return e.abrupt("return",1===n);case 20:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.statics.upload=function(){var t=i()(a.a.mark(function t(n){var r,s,i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("csv"!==n.type){t.next=10;break}return r=v.csv2json(n.content),s=[],i=[],r.forEach(function(t,n){e.product(t).validateSync()?i.push(n+2):s.push(t)}),t.next=7,this.create(s);case 7:return t.t0=!t.sent,t.t1=i,t.abrupt("return",{error:t.t0,errorRows:t.t1});case 10:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),t.statics.getData=function(){var e=i()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("csv"!==t.type){e.next=6;break}return e.next=3,this.find({},{_id:0,__v:0});case 3:return n=e.sent,v.json2csv(n),e.abrupt("return",{error:!0});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.set("autoIndex",!1),e.product=u.a.model("product",t)},k=function(e){var t=new u.a.Schema({slug:{type:String,unique:!0},name:{type:String,required:!0,unique:!0},title:{type:String,unique:!0},content:{type:String},position:{type:Number,required:!0},inMainMenu:{type:Boolean,required:!0}},{collection:"page"});t.statics.getMainMenu=i()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.find({},{_id:0,slug:1,name:1},{sort:{position:1}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),t.statics.getBySlug=function(){var e=i()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findOne({slug:t},{_id:0,__v:0,position:0,name:0,slug:0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.statics.getAll=i()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.find({},{__v:0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),t.statics.update=function(){var e=i()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findOne({_id:new u.a.Types.ObjectId(t._id)});case 2:if(!e.sent){e.next=16;break}if(!t.changes){e.next=10;break}return e.next=7,this.updateOne({_id:new u.a.Types.ObjectId(t._id)},{$set:t.changes});case 7:e.t0=e.sent.ok,e.next=13;break;case 10:return e.next=12,this.remove({_id:new u.a.Types.ObjectId(t._id)});case 12:e.t0=e.sent.ok;case 13:n=e.t0,e.next=19;break;case 16:return e.next=18,this.create(t);case 18:n=1;case 19:return e.abrupt("return",1===n);case 20:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.set("autoIndex",!1),e.page=u.a.model("page",t)},_=function(e){var t=new u.a.Schema({name:{type:String,required:!0,unique:!0},img:String,slug:{type:String,required:!0,unique:!0}},{collection:"category",autoIndex:!1});t.statics.getAll=i()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.find({},{_id:0,__v:0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),t.statics.getBySlug=function(){var e=i()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findOne({slug:t},{__v:0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.methods.getProducts=i()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.product.getByCategoryID(this._id);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)})),t.set("autoIndex",!1),e.category=u.a.model("category",t)},O=function(e){var t=new u.a.Schema({name:{type:String,unique:!0,required:!0},alias:{type:String,required:!0},type:{type:String,required:!0}},{collection:"tab",autoIndex:!1});t.statics.getAll=i()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.find({},{__v:0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),t.statics.update=function(){var e=i()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findOne({_id:new u.a.Types.ObjectId(t._id)});case 2:if(!e.sent){e.next=16;break}if(!t.changes){e.next=10;break}return e.next=7,this.updateOne({_id:new u.a.Types.ObjectId(t._id)},{$set:t.changes});case 7:e.t0=e.sent.ok,e.next=13;break;case 10:return e.next=12,this.remove({_id:new u.a.Types.ObjectId(t._id)});case 12:e.t0=e.sent.ok;case 13:n=e.t0,e.next=19;break;case 16:return e.next=18,this.create(t);case 18:n=1;case 19:return e.abrupt("return",1===n);case 20:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.set("autoIndex",!1),e.tab=u.a.model("tab",t)},T=function(e){var t=new u.a.Schema({name:{type:String,unique:!0,required:!0},alias:{type:String,required:!0},type:{type:String,required:!0}},{collection:"attribute",autoIndex:!1});t.statics.getAll=i()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.find({},{__v:0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),t.statics.update=function(){var e=i()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findOne({_id:new u.a.Types.ObjectId(t._id)});case 2:if(!e.sent){e.next=16;break}if(!t.changes){e.next=10;break}return e.next=7,this.updateOne({_id:new u.a.Types.ObjectId(t._id)},{$set:t.changes});case 7:e.t0=e.sent.ok,e.next=13;break;case 10:return e.next=12,this.remove({_id:new u.a.Types.ObjectId(t._id)});case 12:e.t0=e.sent.ok;case 13:n=e.t0,e.next=19;break;case 16:return e.next=18,this.create(t);case 18:n=1;case 19:return e.abrupt("return",1===n);case 20:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.set("autoIndex",!1),e.attribute=u.a.model("attribute",t)};n.d(t,"user",function(){return d}),n.d(t,"role",function(){return h}),n.d(t,"order",function(){return g}),n.d(t,"product",function(){return w}),n.d(t,"page",function(){return k}),n.d(t,"category",function(){return _}),n.d(t,"tab",function(){return O}),n.d(t,"attribute",function(){return T})},,function(e,t){e.exports=require("jssha")},,function(e,t){e.exports=require("fs")},,,,,,function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),s=n(2),i=n.n(s),o=n(14),u=n.n(o),c=n(5),p=n.n(c),l=n(21),f=n.n(l),d=n(11),h=n.n(d),g=n(3),y=n.n(g),m=n(4),x=n.n(m),b=[{slug:"",name:"Главная",title:"Продажа жироуловителей",content:'<span class="jss240"><p style="text-align:center;"></p>\n<img src="http://bio.alta-region.com/d/811290/d/palets_vverkh.jpg" alt="undefined" style="float:none;height: auto;width: auto">\n<p style="text-align:center;"><span style="color: rgb(102,102,102);font-size: 22px;font-family: Arial, " helvetica="" neue",="" helvetica,="" sans-serif;"="">Наши преимущества</span></p>\n<p style="text-align:center;"><span style="color: rgb(102,102,102);font-size: 15px;font-family: Arial, " helvetica="" neue",="" helvetica,="" sans-serif;"=""><strong>- Курьерская Доставка</strong></span></p>\n<p style="text-align:center;"><span style="color: rgb(102,102,102);font-size: 15px;font-family: Arial, " helvetica="" neue",="" helvetica,="" sans-serif;"=""><strong>- Большой ассортимент</strong></span></p>\n<p style="text-align:center;"><span style="color: rgb(102,102,102);font-size: 15px;font-family: Arial, " helvetica="" neue",="" helvetica,="" sans-serif;"=""><strong>- Удобная система оплаты</strong></span></p>\n<p style="text-align:center;"><span style="color: rgb(102,102,102);font-size: 15px;font-family: Arial, " helvetica="" neue",="" helvetica,="" sans-serif;"=""><strong>- Гибкая система скидок</strong></span></p>\n<p style="text-align:center;"><span style="color: rgb(102,102,102);font-size: 15px;font-family: Arial, " helvetica="" neue",="" helvetica,="" sans-serif;"=""><strong>- Склады в Москве и Санкт-Петербурге</strong></span><br></p>\n</span>',inMainMenu:!0},{slug:"catalog",name:"Каталог",title:"",content:"",inMainMenu:!0},{slug:"promotion",name:"Акции",title:"Акции",content:'<span class="jss252"><p style="text-align:center;"><span style="color: rgb(0,128,0);font-size: 16px;font-family: Times New Roman;"><strong>АКЦИЯ "БЕСПЛАТНАЯ ДОСТАВКА жироуловителей"</strong></span></p>\n<p style="text-align:left;"><span style="color: rgb(0,0,0);font-size: 12pt;font-family: times new roman;">Приобретите жироуловитель (пиковый сброс <strong>до 175 л</strong>) в нашем интернет-магазине и мы доставим этот товар ТК "ПЭК"&nbsp;до&nbsp;ближайшего к Вам терминала (</span><a href="http://pecom.ru/contacts/list-filials/" target="_blank"><span style="color: rgb(0,0,0);background-color: transparent;font-size: 12pt;font-family: times new roman;">все терминалы&nbsp;ПЭК</span></a><span style="color: rgb(0,0,0);font-size: 12pt;font-family: times new roman;">)&nbsp;абсолютно</span> <span style="color: rgb(0,0,0);font-size: 12pt;font-family: times new roman;"><strong>бесплатно*</strong>для Вас</span></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 14px;font-family: Times New Roman;">*Акция не распространяется на Дальневосточный и Сибирский ФО, Республику Дагестан, Калининградскую область</span><br><span style="color: rgb(102,102,102);font-size: 14px;font-family: Times New Roman;">*Акция действует до 31.08.2018 года!!!</span><br><span style="color: rgb(102,102,102);font-size: 14px;font-family: Times New Roman;">*Акция распространяется на жироуловители (пиковый сброс до 175 л), биопрепараты</span><br><span style="color: rgb(102,102,102);font-size: 14px;font-family: Times New Roman;">*Акция действует при оплате товара по ценам, указанным на сайте</span><br><span style="color: rgb(102,102,102);font-size: 14px;font-family: Times New Roman;">*Доставка осуществляется не ранее, чем на следующий день&nbsp;</span><br><span style="color: rgb(102,102,102);font-size: 14px;font-family: Times New Roman;">*Доставка в регионы бесплатна при: 100% оплате товара на сумму более 3000 р.</span><br><span style="color: rgb(102,102,102);font-size: 14px;font-family: Times New Roman;">*Доставка по акции в регионы осуществляется ТК "ПЭК"</span><br><span style="color: rgb(102,102,102);font-size: 14px;font-family: Times New Roman;">*Доставка в пределах МКАД бесплатна как при оплате товара курьеру, так и при предоплате</span><br><span style="color: rgb(102,102,102);font-size: 14px;font-family: Times New Roman;">*Доставка в пределах КАД бесплатна как при оплате товара курьеру, так и при предоплате (только из наличия на складе в СПб)</span><br><span style="color: rgb(102,102,102);font-size: 14px;font-family: Times New Roman;">*Доставка за пределы КАД и МКАД оплачивается 30 р/км (расчет ведется согласно данным яндекс.навигатор в одну сторону)</span></p>\n</span>',inMainMenu:!0},{slug:"delivery",name:"Доставка и оплата",title:"Доставка",content:'<span class="jss264"><h2 style="text-align:left;"><span style="color: rgb(255,255,255);background-color: rgb(2,134,82);font-size: 22px;">Оплата товаров</span></h2>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">-</span> <span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;"><strong>Предоплата.&nbsp;Оплата по счету</strong>. Счет можно получить оформив заказ на сайте или позвонив нашим менеджерам. После оформления заказа Вам выставляется счет на оплату, который действителен в течение трех рабочих дней. Счет также можно распечатать в разделе "Мои заказы".</span></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">-</span> <span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;"><strong>Предоплата.&nbsp;Оплата по квитанции</strong>. Квитанцию&nbsp;можно получить оформив заказ на сайте или позвонив нашим менеджерам. После оформления заказа квитанция формируется автоматически в разделе "Мои заказы". Квитанция действительна в течение трех рабочих дней.&nbsp;</span></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">-</span> <span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;"><strong>Оплата наличными при получении у курьера</strong>. Оплата наличными производится курьеру при получении.</span> <br><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">Стоимость доставки (менее 15 кг) - 600 (шестьсот) рублей&nbsp;(Бесплатно по акции) - в пределах МКАД (г. Москва)</span></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;"><strong>- Оплата при получении на терминале ПЭК. &nbsp;</strong></span><br><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">Стоимость доставки Транспортной Компанией ПЭК до терминала ПЭК для ЦФО составляет от 800 р. (в акциях не участвует)</span></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;"><strong>- Оплата при получении на Почте России (уточняйте возможность).&nbsp;</strong></span><br><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">Стоимость доставки Почтой России рассчитывается для каждого отправления. Не все товары могут быть отправлены Почтой России. Почта России взымает дополнительную комиссию за перевод денег.</span></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">-&nbsp;<strong>Оплата наличными при самовывозе</strong>. Оплата наличными производится на складе.&nbsp;</span><br><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">Самовывоз товаров со склада в г.Москва (</span><a href="http://bio.alta-region.com/kontakty" target="_blank"><span style="color: rgb(0,136,204);background-color: transparent;font-size: 13px;font-family: Arial, Helvetica, sans-serif;">адрес</span></a><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">) - бесплатно</span></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">-&nbsp;<strong>Предоплата. Безопасная оплата&nbsp;на сайте</strong>. Оплата производится через яндекс.кассы (</span><a href="https://money.yandex.ru/actions" target="_blank"><span style="color: rgb(0,136,204);background-color: transparent;font-size: 13px;font-family: Arial, Helvetica, sans-serif;">яндекс.деньги</span></a><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">) прямо на сайте.</span> <br><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">Оплатить можно оформив заказ на сайте. При оформлении заказа необходимо выбрать пункт "Яндекс.Деньги. Оплата на сайте). После оформления заказа оплата поступает моментально.</span></p>\n<h2 style="text-align:left;"><span style="color: rgb(255,255,255);background-color: rgb(2,134,82);font-size: 22px;">Стоимость доставки жироуловителя</span></h2>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;"><strong>По России:</strong></span> <span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">Точную стоимость доставки в любой город Вы можете рассчитать в карточке каждого товара на вкладке "Доставка", либо обратившись к нашим менеджерам.&nbsp;Бесплатно по акции.</span></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;"><strong>В пределах МКАД (г.Москва):</strong></span></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">- Стоимость доставки жироуловителя курьером в пределах МКАД составляет 600 рублей (Бесплатно по акции).</span></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">- Доставка подмоечных жироуловителей в г.Москва, производство которых находится в других городах, "До дверей"составляет от 900 рублей.</span></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">Доставка из других регионов осуществляется Транспортными Компаниями (Деловые Линии, ПЭК и др.)&nbsp;</span></p>\n<p style="text-align:left;">&nbsp;</p>\n<h2 style="text-align:left;"><span style="color: rgb(51,51,51);font-size: 24px;">Доставка в Республики</span></h2>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">Уточняйте возможность доставки в Республики&nbsp;</span></p>\n<h2 style="text-align:left;"><span style="color: rgb(255,255,255);background-color: rgb(2,134,82);font-size: 22px;">О документах</span></h2>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">При оплате наличными Покупателю предоставляется кассовый (он же товарный) чек.</span></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">При безналичной оплате (на р/с предприятия) Покупателю предоставляется Товарная Накладная и счет-фактура&nbsp;</span></p>\n<p style="text-align:left;">&nbsp;</p>\n<h2 style="text-align:center;"><span style="color: rgb(255,255,255);background-color: rgb(2,134,82);font-size: 22px;">Уважаемый покупатель!</span></h2>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">Чтобы приобрести какой-либо товар на нашем сайте Вам необходимо:&nbsp;</span></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">1. Позвонить нашему менеджеру&nbsp;</span><a href="tel:+74994040557" target="_self"><span style="color: rgb(0,136,204);background-color: transparent;font-size: 13px;font-family: Arial, Helvetica, sans-serif;">+7&nbsp;(499) 404-05-57</span></a></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;"><strong>ЛИБО</strong></span></p>\n<p><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">1. Добавить товар в корзину (это можно сделать &nbsp;при просмотре товара)</span></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">2. Перейти в "корзину"</span></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">3. Войти в свой профиль или выбрать пункт "купить без регистрации"</span></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">4. Выбрать способ доставки</span></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">5. Ввести свое имя, телефон</span></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">6. Выбрать способ оплаты (наличными менеджеру, квитанцией, оплата счета или через Яндекс.Деньги)</span></p>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">7. Ожидать звонка менеджера нашей компании.</span></p>\n<p style="text-align:left;">&nbsp;</p>\n<h2 style="text-align:left;"><span style="color: rgb(51,51,51);font-size: 24px;">О возвратах</span></h2>\n<p style="text-align:left;"><span style="color: rgb(102,102,102);font-size: 13px;font-family: Arial, Helvetica, sans-serif;">В случае необходимости возврата товара по любым причинам перевозка до склада Продавца/Поставщика оплачивается Покупателем (стороной, которая возвращает Товар).</span></p>\n</span>',inMainMenu:!0},{slug:"about",name:"О компании",title:"О компании",content:"В то время как космические корабли бороздят...",inMainMenu:!0},{slug:"contacts",name:"Контакты",title:"Контакты",content:'<span class="jss288"><p style="text-align:left;"><span style="color: rgb(51,51,51);font-size: 18px;font-family: Times New Roman;"><strong>Москва:&nbsp;</strong></span><a href="tel:+74994040557" target="_self"><span style="color: rgb(51,51,51);background-color: transparent;font-size: 11pt;font-family: Times New Roman;"><strong>+7 (499) 404-05-57</strong></span></a><br><span style="color: rgb(51,51,51);font-size: 18px;font-family: Times New Roman;"><strong>Санкт-Петербург:</strong></span> <a href="tel:+78124095254" target="_self"><span style="color: rgb(51,51,51);background-color: transparent;font-size: 11pt;font-family: Times New Roman;"><strong>+7 (812) 409-52-54</strong></span></a></p>\n<p style="text-align:left;"><span style="color: rgb(51,51,51);font-size: 18px;font-family: Times New Roman;"><strong>написать в:&nbsp;</strong></span> <a href="https://api.whatsapp.com/send?phone=79190349987" target="_self"><span style="color: rgb(51,51,51);background-color: transparent;font-size: 11pt;font-family: Times New Roman;"><strong>Whatsapp</strong></span></a><span style="color: rgb(51,51,51);font-size: 11pt;font-family: Times New Roman;"><strong>&nbsp;.....&nbsp;</strong></span><a href="viber://add?number=79190349987" target="_self"><span style="color: rgb(51,51,51);background-color: transparent;font-size: 11pt;font-family: Times New Roman;"><strong>Viber</strong></span></a></p>\n<p style="text-align:left;"><span style="color: rgb(51,51,51);font-size: 18px;font-family: Times New Roman;"><strong>написать на почту:&nbsp;</strong></span><a href="mailto:alta-region@mail.ru" target="_self"><span style="color: rgb(51,51,51);background-color: transparent;font-size: 11pt;font-family: Times New Roman;"><strong>alta-region@mail.ru</strong></span></a></p>\n<p style="text-align:left;"></p>\n<p style="text-align:center;"></p>\n</span>',inMainMenu:!0}],v=[{slug:"vse_zhirouloviteli",name:"Жироуловители",img:"/uploads/on5fbrxucpmhtzkklqtm.jpg"},{slug:"zhirouloviteli_pod_moyku",name:"Жироуловители под мойку",img:"/uploads/on5fbrxucpmhtzkklqtm.jpg"},{slug:"mufty-dlya-trub",name:"Муфты для труб и кабелей",img:"/uploads/on5fbrxucpmhtzkklqtm.jpg"}],w=[{},{},{},{},{},{},{},{},{}],k=n(17),_=Object.keys(k.a);_.splice(_.indexOf("guest"),1);var O=[{name:"client",alias:"Клиент",permissions:["client"]},{name:"banned",alias:"Заблокированный пользователь",permissions:[]}],T=function(){function e(){y()(this,e)}return x()(e,null,[{key:"init",value:function(t){this.db=t,e.generate()}},{key:"generate",value:function(){var t=i()(a.a.mark(function t(){var n,r,s=this;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=0,t.next=3,e.setData("page",b,function(){var e=i()(a.a.mark(function e(t,r){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new r(h()({},t,{position:++n})).save();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}());case 3:return t.next=5,e.setData("category",v,function(){var e=i()(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new n(t).save();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}());case 5:return r=0,t.next=8,e.setData("product",w,function(){var e=i()(a.a.mark(function e(t,n){var i,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.db.category.findOne();case 2:return i=e.sent,t.categoryID=i._id,t.code="ART"+ ++r,t.name="Продукт "+r,t.slug="product"+r,t.price=1e3*r,o="/uploads/on5fbrxucpmhtzkklqtm.jpg",t.media=[o,o,o],t.props=[{name:"Производитель",value:"Китай"},{name:"Любой параметр",value:"Любое значение"},{name:"Любой параметр2",value:"Любое значение2"},{name:"Любой параметр3",value:"Любое значение3"},{name:"Любой параметр4",value:"Любое значение4"},{name:"Любой параметр5",value:"Любое значение5"}],e.next=13,new n(t).save();case 13:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}());case 8:return t.next=10,e.setData("role",O,function(){var e=i()(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new n(t).save();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}());case 10:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"setData",value:function(){var e=i()(a.a.mark(function e(t,n,r){var s=this;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.db[t].countDocuments();case 2:if(e.t0=e.sent,!(e.t0>0)){e.next=5;break}return e.abrupt("return");case 5:n.forEach(function(){var e=i()(a.a.mark(function e(n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(n,s.db[t]);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()}]),e}(),z=n(10),A=n(19);i()(a.a.mark(function e(){var t,n,r,s,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return p.a.connect(z.a.db.url,{autoIndex:!1}),p.a.connection.on("error",console.error.bind(console,"connection error:")),p.a.connection.once("open",console.error.bind(console,"connected to db")),t={},Object.keys(A).forEach(function(e){return A[e](t)}),T.init(t),n={password:"!ololo#2018FMT$",phone:"123456",email:"shadowasp2@yandex.ru",name:"Max",lastname:"Yashkov"},e.next=9,t.user.getByEmail(n.email);case 9:return e.sent&&console.log("этот email уже занят"),(r=new f.a("SHA-512","TEXT")).update(n.email+n.password),n.password=r.getHash("HEX"),e.next=16,u.a.genSalt(10);case 16:return s=e.sent,e.next=19,u.a.hash(n.password,s);case 19:i=e.sent,new t.user({email:n.email,phone:n.phone,password:i,name:n.name,lastname:n.lastname,role:"root",isActive:!0}).save(),console.log("=========THE END=========");case 22:case"end":return e.stop()}},e,this)}))()}]);